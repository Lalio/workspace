var $btnNext=$(".next-page-btn"),$btnHide=$(".hide-page-btn"),$xzScroll=$(".zx__scroll"),scrollsection1=$(".scroll__section1"),scrollsection2=$(".scroll__section2"),scrollsection3=$(".scroll__section3"),scrollsection4=$(".scroll__section4"),loadFlag=!0;!function(){var c={indexURL:"//api.xzbbm.cn/?action\x3dSuperAPI",universityId:0,imageScroll:function(){LEGO.imageScroll("#imgscroll",{mousewheel:!1})},textSlider:function(){$(".codetxt--scroll").textSlider({line:1,speed:500,timer:3E3})},showControl:function(){$btnNext.on("click",function(){$(".zx__scroll").show();$("html,body").animate({scrollTop:"1250px"},600,function(){c.loadAction();c.loadActionScroll();$btnNext.hide();$btnHide.show()})});$btnHide.on("click",function(){$(this).hide();$xzScroll.hide();$btnNext.show();$(window).off("scroll",c.scrollFun);scrollsection1.removeClass("active");scrollsection2.removeClass("active");scrollsection3.removeClass("active");scrollsection4.removeClass("active")})},scrollFun:function(){var a=$(window).height()-210,g=$(window).scrollTop(),e=scrollsection1.offset().top,c=scrollsection2.offset().top,d=scrollsection3.offset().top,b=scrollsection4.offset().top;!scrollsection1.hasClass("active")&&e-g<a&&scrollsection1.addClass("active");!scrollsection2.hasClass("active")&&c-g<a&&scrollsection2.addClass("active");!scrollsection3.hasClass("active")&&d-g<a&&scrollsection3.addClass("active");!scrollsection4.hasClass("active")&&b-g<a&&scrollsection4.addClass("active")},loadActionScroll:function(){if("block"==$xzScroll.css("display"))$(window).on("scroll",c.scrollFun)},loadAction:function(){if("block"==$xzScroll.css("display")){var a=$(window).height()-210,g=$(window).scrollTop(),e=scrollsection1.offset().top,c=scrollsection2.offset().top,d=scrollsection3.offset().top,b=scrollsection4.offset().top;!scrollsection1.hasClass("active")&&e-g<a&&scrollsection1.addClass("active");!scrollsection2.hasClass("active")&&c-g<a&&scrollsection2.addClass("active");!scrollsection3.hasClass("active")&&d-g<a&&scrollsection3.addClass("active");!scrollsection4.hasClass("active")&&b-g<a&&scrollsection4.addClass("active")}},getSchoolRequest:function(a){$.ajax({url:c.indexURL+'\x26do\x3dWebUniversity\x26debug\x3don\x26msg\x3d{"char_1":"'+a+'"}',type:"get",dataType:"jsonp",success:function(a){for(var e=a.university,f=e.length,d="",b=0;b<f;b++)0==b?(d+='\x3cli id\x3d"clicked" university_id\x3d"'+e[b].university_id+'" title\x3d"'+e[b].name+'"\x3e'+e[b].name+"\x3c/li\x3e",c.universityId=e[b].university_id):d+='\x3cli university_id\x3d"'+e[b].university_id+'" title\x3d"'+e[b].name+'"\x3e'+e[b].name+"\x3c/li\x3e";$("#school-name ul").html(d);$("#school-name").jScrollPane();for(var f=a.college_list,d=f.length,h="",b=0;b<d;b++)h=0==b?h+('\x3cli id\x3d"clicked" college_id\x3d"'+f[b].college_id+'" title\x3d"'+f[b].college+'"\x3e'+f[b].college+"\x3c/li\x3e"):h+('\x3cli college_id\x3d"'+f[b].college_id+'" title\x3d"'+f[b].college+'"\x3e'+f[b].college+"\x3c/li\x3e");$("#school-academy ul").html(h);$("#school-academy").jScrollPane();a=a.document_list;d=a.length;h="";if(0==d)$(".data-none").show();else{for(b=0;b<d;b++)h+='\x3cli file_id\x3d"'+a[b].file_id+'" title\x3d"'+a[b].file_name+'"\x3e\x3ca href\x3d"'+a[b].web_url+'" target\x3d"_blank"\x3e'+a[b].file_name+"\x3c/a\x3e\x3c/li\x3e";h+='\x3cli university_id\x3d"'+e[0].university_id+'" college_id\x3d"'+f[0].college_id+'" class\x3d"more_file"\x3e\x3ca href\x3d"javascript:;" style\x3d"outline:0;"\x3e[+] \u66f4\u591a\x3c/a\x3e\x3c/li\x3e'}$("#academy-file ul").html(h)},error:function(){}})},triggerSendRequest:function(){var a="A",g;$(".school-initial ul li span").on("click",function(){c.from_index=1;$(this).html()!=a&&($(".data-none").hide(),$("#school-name,#school-academy,#academy-file").find("ul").html('\x3cdiv id\x3d"loading"\x3e\x3c/div\x3e'),$(".school-initial ul li span").removeAttr("id"),$(this).attr("id","clicked"),a=$(this).html(),c.getSchoolRequest(a.toLowerCase()))});$(document).on("click","#school-name ul li",function(){c.from_index=1;var a=$(this).attr("university_id");a!=c.universityId&&($(".data-none").hide(),c.universityId=a,$(this),$("#school-name ul li").removeAttr("id"),$(this).attr("id","clicked"),university_id=a,$("#school-academy ul,#academy-file ul").html('\x3cdiv id\x3d"loading"\x3e\x3c/div\x3e'),c.getCollegesRequest(university_id))});$(document).on("click","#school-academy ul li",function(){c.from_index=1;if(loadFlag){loadFlag=!1;$(".data-none").hide();var a=$(this);$("#school-academy ul li").removeAttr("id");$(this).attr("id","clicked");g=a.attr("college_id");$("#academy-file ul").html('\x3cdiv id\x3d"loading"\x3e\x3c/div\x3e');c.getFileRequest(c.universityId,g,12,0)}});$(document).on("click",".more_file",function(){$(".data-none").hide();var a=$(this),g=a.attr("college_id"),a=a.attr("university_id");$("#academy-file ul").html('\x3cdiv id\x3d"loading"\x3e\x3c/div\x3e');c.getFileRequest(a,g,12,c.from_index)})},from_index:1,getCollegesRequest:function(a){$.ajax({url:c.indexURL+'\x26do\x3dWebSelect\x26debug\x3don\x26msg\x3d{"ucode":'+a+',"ccode":0,"limit":12,"from":0}',type:"get",dataType:"jsonp",success:function(c){for(var e=c.college_list,f=e.length,d="",b=0;b<f;b++)0==b?(first_college_id=e[b].college_id,d+='\x3cli id\x3d"clicked" college_id\x3d"'+e[b].college_id+'" title\x3d"'+e[b].college+'"\x3e'+e[b].college+"\x3c/li\x3e"):d+='\x3cli college_id\x3d"'+e[b].college_id+'" title\x3d"'+e[b].college+'"\x3e'+e[b].college+"\x3c/li\x3e";$("#school-academy ul").html(d);$("#school-academy").jScrollPane();c=c.document_list;f=c.length;d="";if(0==f)$(".data-none").show();else{11<=f&&f--;for(b=0;b<f;b++)d+='\x3cli file_id\x3d"'+c[b].file_id+'" title\x3d"'+c[b].file_name+'"\x3e\x3ca href\x3d"'+c[b].web_url+'" target\x3d"_blank"\x3e'+c[b].file_name+"\x3c/a\x3e\x3c/li\x3e";d+='\x3cli university_id\x3d"'+a+'" college_id\x3d"'+e[0].college_id+'" class\x3d"more_file"\x3e\x3ca href\x3d"javascript:;" style\x3d"outline:0;"\x3e[+] \u66f4\u591a\x3c/a\x3e\x3c/li\x3e'}$("#academy-file ul").html(d)},error:function(){}})},getFileRequest:function(a,g,e,f){$.ajax({url:c.indexURL+'\x26do\x3dWebSelect\x26debug\x3don\x26msg\x3d{"ucode":'+a+',"ccode":'+g+',"limit":'+e+',"from":'+11*f+"}",type:"get",dataType:"jsonp",success:function(d){d=d.document_list;var b=d.length,e="";if(0==b)$(".data-none").show();else{11<=b&&b--;for(var f=0;f<b;f++)e+='\x3cli file_id\x3d"'+d[f].file_id+'" title\x3d"'+d[f].file_name+'"\x3e\x3ca href\x3d"'+d[f].web_url+'" target\x3d"_blank"\x3e'+d[f].file_name+"\x3c/a\x3e\x3c/li\x3e";11<=b&&(c.from_index++,e+='\x3cli university_id\x3d"'+a+'" college_id\x3d"'+g+'" class\x3d"more_file"\x3e\x3ca href\x3d"javascript:;" style\x3d"outline:0;"\x3e[+] \u66f4\u591a\x3c/a\x3e\x3c/li\x3e')}$("#academy-file ul").html(e);setTimeout(function(){loadFlag=!0},500)},error:function(){}})},emailTimer:null,sendEmail:function(){$("#sendemail-form-submit").on("click",function(){clearInterval(c.emailTimer);var a=$.trim($("#sendemail").val());""===a?$("#sendmail-error-tips").html("\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\uff01"):/([a-z0-9]*[-_.]?[a-z0-9]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+[.][a-z]{2,3}([.][a-z]{2})?/i.test(a)?($.cookie("findback_email",a),c.sendEmailAjax(a)):$("#sendmail-error-tips").html("\u90ae\u7bb1\u683c\u5f0f\u9519\u8bef\uff01")})},inviteRegInit:function(){-1!=location.href.indexOf("?welcome")&&wilson.popupBox("none",{boxSelector:".register-popbox"})},changePasswordInit:function(){var a=location.href;-1!=a.indexOf("reset_token")&&(a=a.split("?")[1].split(":"),a=a[1].substring(3,a[1].length-3),$.cookie("reset_token",a),wilson.popupBox("none",{boxSelector:".findback-popbox"}))},changePasswordAjax:function(){$("#findback-btn").on("click",function(){var a=$.trim($("#new-password").val());""==a?$("#findback-error-tips").html("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01"):($(".submit-loading").show(),$.ajax({url:c.indexURL+'\x26do\x3dWebUpdateUser\x26debug\x3don\x26msg\x3d{"email":"'+$.cookie("email")+'","key":"password","value":"'+hex_md5(a)+'","xztoken":"'+$.cookie("reset_token")+'"}',type:"get",dataType:"jsonp",success:function(a){$(".submit-loading").hide();window.location="http://xzbbm.cn"}}))})},verifyResult:function(){-1!=location.href.indexOf("?authok")&&($("#commonmessage").html("\u60a8\u7684\u90ae\u7bb1\u5df2\u7ecf\u901a\u8fc7\u9a8c\u8bc1\uff01"),wilson.popupBox("none",{boxSelector:".commonmessage-popbox"}))},init:function(){this.imageScroll();this.textSlider();this.showControl();this.getSchoolRequest("a");this.triggerSendRequest();this.sendEmail();this.changePasswordInit();this.changePasswordAjax();this.inviteRegInit();this.verifyResult()}};"undefined"!==typeof c&&(window.index=c);c.init()}();